<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>API &mdash; Momoko 1.1.6 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.1.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Momoko 1.1.6 documentation" href="index.html" />
    <link rel="prev" title="Tutorial" href="tutorial.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tutorial.html" title="Tutorial"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Momoko 1.1.6 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="module-momoko"><span id="api"></span></span><div class="section" id="id1">
<h1>API<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>Classes, methods and stuff.</p>
<div class="section" id="connections">
<h2>Connections<a class="headerlink" href="#connections" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="momoko.Pool">
<em class="property">class </em><tt class="descclassname">momoko.</tt><tt class="descname">Pool</tt><big>(</big><em>dsn</em>, <em>connection_factory=None</em>, <em>cursor_factory=None</em>, <em>size=1</em>, <em>max_size=None</em>, <em>callback=None</em>, <em>ioloop=None</em>, <em>raise_connect_errors=True</em>, <em>reconnect_interval=500</em>, <em>setsession=</em><span class="optional">[</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#momoko.Pool" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronous connection pool.</p>
<p>The pool manages database connections and passes operations to connections.</p>
<p>See <a class="reference internal" href="#momoko.Connection" title="momoko.Connection"><tt class="xref py py-class docutils literal"><span class="pre">momoko.Connection</span></tt></a> for documentation about the <tt class="docutils literal"><span class="pre">dsn</span></tt>,
<tt class="docutils literal"><span class="pre">connection_factory</span></tt> and <tt class="docutils literal"><span class="pre">cursor_factory</span></tt> parameters.
These are used by the connection pool when a new connection is created.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>size</strong> (<em>integer</em>) &#8211; Amount of connections created upon initialization. Defaults to <tt class="docutils literal"><span class="pre">1</span></tt>.</li>
<li><strong>max_size</strong> (<em>integer</em>) &#8211; Allow number of connection to grow under load up to given size. Defaults to <tt class="docutils literal"><span class="pre">size</span></tt>.</li>
<li><strong>callback</strong> (<em>callable</em>) &#8211; A callable that&#8217;s called after all the connections are created. Defaults to <tt class="docutils literal"><span class="pre">None</span></tt>.</li>
<li><strong>ioloop</strong> &#8211; An instance of Tornado&#8217;s IOLoop. Defaults to <tt class="docutils literal"><span class="pre">None</span></tt>, <tt class="docutils literal"><span class="pre">IOLoop.instance()</span></tt> will be used.</li>
<li><strong>raise_connect_errors</strong> (<em>bool</em>) &#8211; Whether to raise exception if database connection fails. Set to <tt class="docutils literal"><span class="pre">False</span></tt> to enable
automatic reconnection attempts. Defaults to <tt class="docutils literal"><span class="pre">True</span></tt>.</li>
<li><strong>reconnect_interval</strong> (<em>integer</em>) &#8211; When using automatic reconnects, set minimum reconnect interval, in milliseconds,
before retrying connection attempt. Don&#8217;t set this value too low to prevent &#8220;banging&#8221;
the database server with connection attempts. Defaults to <tt class="docutils literal"><span class="pre">500</span></tt>.</li>
<li><strong>setsession</strong> (<em>list</em>) &#8211; List of intial sql commands to be executed once connection is established.
If any of the commands failes, the connection will be closed.
<strong>NOTE:</strong> The commands will be executed as one transaction block.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="momoko.Pool.callproc">
<tt class="descname">callproc</tt><big>(</big><em>procname</em>, <em>parameters=()</em>, <em>cursor_factory=None</em>, <em>callback=None</em><big>)</big><a class="headerlink" href="#momoko.Pool.callproc" title="Permalink to this definition">¶</a></dt>
<dd><p>Call a stored database procedure with the given name.</p>
<p>See <a class="reference internal" href="#momoko.Connection.callproc" title="momoko.Connection.callproc"><tt class="xref py py-meth docutils literal"><span class="pre">momoko.Connection.callproc()</span></tt></a> for documentation about the
parameters.</p>
</dd></dl>

<dl class="method">
<dt id="momoko.Pool.close">
<tt class="descname">close</tt><big>(</big><big>)</big><a class="headerlink" href="#momoko.Pool.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the connection pool.</p>
</dd></dl>

<dl class="method">
<dt id="momoko.Pool.execute">
<tt class="descname">execute</tt><big>(</big><em>operation</em>, <em>parameters=()</em>, <em>cursor_factory=None</em>, <em>callback=None</em><big>)</big><a class="headerlink" href="#momoko.Pool.execute" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare and execute a database operation (query or command).</p>
<p>See <a class="reference internal" href="#momoko.Connection.execute" title="momoko.Connection.execute"><tt class="xref py py-meth docutils literal"><span class="pre">momoko.Connection.execute()</span></tt></a> for documentation about the
parameters.</p>
</dd></dl>

<dl class="method">
<dt id="momoko.Pool.getconn">
<tt class="descname">getconn</tt><big>(</big><em>ping=True</em>, <em>callback=None</em><big>)</big><a class="headerlink" href="#momoko.Pool.getconn" title="Permalink to this definition">¶</a></dt>
<dd><p>Acquire connection from the pool.</p>
<p>You can then use this connection for subsequest queries.
Just supply, for example, <tt class="docutils literal"><span class="pre">connection.execute</span></tt> instead of <tt class="docutils literal"><span class="pre">Pool.execute</span></tt>
to <tt class="docutils literal"><span class="pre">momoko.Op</span></tt>.</p>
<p>Make sure to return connection to the pool by calling <a class="reference internal" href="#momoko.Pool.putconn" title="momoko.Pool.putconn"><tt class="xref py py-meth docutils literal"><span class="pre">momoko.Pool.putconn()</span></tt></a>,
otherwise the connection will remain forever-busy and you&#8217;ll starvate your pool quickly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ping</strong> (<em>boolean</em>) &#8211; Whether to ping connection before returning it by executing <a class="reference internal" href="#momoko.Pool.ping" title="momoko.Pool.ping"><tt class="xref py py-meth docutils literal"><span class="pre">momoko.Pool.ping()</span></tt></a>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="momoko.Pool.manage">
<tt class="descname">manage</tt><big>(</big><em>*args</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#momoko.Pool.manage" title="Permalink to this definition">¶</a></dt>
<dd><p>Context manager that automatically returns connection to the pool.
You can use it instead of <a class="reference internal" href="#momoko.Pool.putconn" title="momoko.Pool.putconn"><tt class="xref py py-meth docutils literal"><span class="pre">momoko.Pool.putconn()</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">connection</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">momoko</span><span class="o">.</span><span class="n">Op</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">getconn</span><span class="p">)</span>
<span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">manage</span><span class="p">(</span><span class="n">connection</span><span class="p">):</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">momoko</span><span class="o">.</span><span class="n">Op</span><span class="p">(</span><span class="n">connection</span><span class="o">.</span><span class="n">execute</span><span class="p">,</span> <span class="s">&quot;BEGIN&quot;</span><span class="p">)</span>
    <span class="o">...</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="momoko.Pool.mogrify">
<tt class="descname">mogrify</tt><big>(</big><em>operation</em>, <em>parameters=()</em>, <em>callback=None</em><big>)</big><a class="headerlink" href="#momoko.Pool.mogrify" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a query string after arguments binding.</p>
<p>See <a class="reference internal" href="#momoko.Connection.mogrify" title="momoko.Connection.mogrify"><tt class="xref py py-meth docutils literal"><span class="pre">momoko.Connection.mogrify()</span></tt></a> for documentation about the
parameters.</p>
</dd></dl>

<dl class="method">
<dt id="momoko.Pool.ping">
<tt class="descname">ping</tt><big>(</big><em>connection</em>, <em>callback=None</em><big>)</big><a class="headerlink" href="#momoko.Pool.ping" title="Permalink to this definition">¶</a></dt>
<dd><p>Ping given connection object to make sure its alive (involves roundtrip to the database server).</p>
<p>See <a class="reference internal" href="#momoko.Connection.ping" title="momoko.Connection.ping"><tt class="xref py py-meth docutils literal"><span class="pre">momoko.Connection.ping()</span></tt></a> for documentation about the details.</p>
</dd></dl>

<dl class="method">
<dt id="momoko.Pool.putconn">
<tt class="descname">putconn</tt><big>(</big><em>connection</em><big>)</big><a class="headerlink" href="#momoko.Pool.putconn" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrun busy connection back to the pool.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>connection</strong> (<em>Connection</em>) &#8211; Connection object previously returned by <a class="reference internal" href="#momoko.Pool.getconn" title="momoko.Pool.getconn"><tt class="xref py py-meth docutils literal"><span class="pre">momoko.Pool.getconn()</span></tt></a>.
<strong>NOTE:</strong> This is a synchronous function</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="momoko.Pool.register_hstore">
<tt class="descname">register_hstore</tt><big>(</big><em>unicode=False</em>, <em>callback=None</em><big>)</big><a class="headerlink" href="#momoko.Pool.register_hstore" title="Permalink to this definition">¶</a></dt>
<dd><p>Register adapter and typecaster for <tt class="docutils literal"><span class="pre">dict-hstore</span></tt> conversions.</p>
<p>See <a class="reference internal" href="#momoko.Connection.register_hstore" title="momoko.Connection.register_hstore"><tt class="xref py py-meth docutils literal"><span class="pre">momoko.Connection.register_hstore()</span></tt></a> for documentation about
the parameters. This method has no <tt class="docutils literal"><span class="pre">globally</span></tt> parameter, because it
already registers hstore to all the connections in the pool.</p>
</dd></dl>

<dl class="method">
<dt id="momoko.Pool.register_json">
<tt class="descname">register_json</tt><big>(</big><em>loads=None</em>, <em>callback=None</em><big>)</big><a class="headerlink" href="#momoko.Pool.register_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Register adapter and typecaster for <tt class="docutils literal"><span class="pre">dict-json</span></tt> conversions.</p>
<p>See <a class="reference internal" href="#momoko.Connection.register_json" title="momoko.Connection.register_json"><tt class="xref py py-meth docutils literal"><span class="pre">momoko.Connection.register_json()</span></tt></a> for documentation about
the parameters. This method has no <tt class="docutils literal"><span class="pre">globally</span></tt> parameter, because it
already registers json to all the connections in the pool.</p>
</dd></dl>

<dl class="method">
<dt id="momoko.Pool.transaction">
<tt class="descname">transaction</tt><big>(</big><em>statements</em>, <em>cursor_factory=None</em>, <em>callback=None</em><big>)</big><a class="headerlink" href="#momoko.Pool.transaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a sequence of SQL queries in a database transaction.</p>
<p>See <a class="reference internal" href="#momoko.Connection.transaction" title="momoko.Connection.transaction"><tt class="xref py py-meth docutils literal"><span class="pre">momoko.Connection.transaction()</span></tt></a> for documentation about the
parameters.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="momoko.Connection">
<em class="property">class </em><tt class="descclassname">momoko.</tt><tt class="descname">Connection</tt><a class="headerlink" href="#momoko.Connection" title="Permalink to this definition">¶</a></dt>
<dd><p>Initiate an asynchronous connect.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dsn</strong> (<em>string</em>) &#8211; <p>A <a class="reference external" href="http://en.wikipedia.org/wiki/Data_Source_Name">Data Source Name</a> string containing one of the following values:</p>
<ul>
<li><strong>dbname</strong> - the database name</li>
<li><strong>user</strong> - user name used to authenticate</li>
<li><strong>password</strong> - password used to authenticate</li>
<li><strong>host</strong> - database host address (defaults to UNIX socket if not provided)</li>
<li><strong>port</strong> - connection port number (defaults to 5432 if not provided)</li>
</ul>
<p>Or any other parameter supported by PostgreSQL. See the PostgreSQL
documentation for a complete list of supported <a class="reference external" href="http://www.postgresql.org/docs/current/static/libpq-connect.html#LIBPQ-PQCONNECTDBPARAMS">parameters</a>.</p>
</li>
<li><strong>connection_factory</strong> &#8211; The <tt class="docutils literal"><span class="pre">connection_factory</span></tt> argument can be used to create non-standard
connections. The class returned should be a subclass of <a class="reference external" href="http://initd.org/psycopg/docs/connection.html#connection">psycopg2.extensions.connection</a>.
See <a class="reference external" href="http://initd.org/psycopg/docs/advanced.html#subclassing-cursor">Connection and cursor factories</a> for details. Defaults to <tt class="docutils literal"><span class="pre">None</span></tt>.</li>
<li><strong>cursor_factory</strong> &#8211; The <tt class="docutils literal"><span class="pre">cursor_factory</span></tt> argument can be used to return non-standart cursor class
The class returned should be a subclass of <a class="reference external" href="http://initd.org/psycopg/docs/extensions.html#psycopg2.extensions.cursor">psycopg2.extensions.cursor</a>.
See <a class="reference external" href="http://initd.org/psycopg/docs/advanced.html#subclassing-cursor">Connection and cursor factories</a> for details. Defaults to <tt class="docutils literal"><span class="pre">None</span></tt>.</li>
<li><strong>callback</strong> (<em>callable</em>) &#8211; A callable that&#8217;s called after the connection is created. It accepts one
paramater: an instance of <a class="reference internal" href="#momoko.Connection" title="momoko.Connection"><tt class="xref py py-class docutils literal"><span class="pre">momoko.Connection</span></tt></a>. Defaults to <tt class="docutils literal"><span class="pre">None</span></tt>.</li>
<li><strong>ioloop</strong> &#8211; An instance of Tornado&#8217;s IOLoop. Defaults to <tt class="docutils literal"><span class="pre">None</span></tt>.</li>
<li><strong>setsession</strong> (<em>list</em>) &#8211; List of intial sql commands to be executed once connection is established.
If any of the commands failes, the connection will be closed.
<strong>NOTE:</strong> The commands will be executed as one transaction block.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="momoko.Connection.busy">
<tt class="descname">busy</tt><big>(</big><big>)</big><a class="headerlink" href="#momoko.Connection.busy" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>(Deprecated)</strong> Check if the connection is busy or not.</p>
</dd></dl>

<dl class="method">
<dt id="momoko.Connection.callproc">
<tt class="descname">callproc</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#momoko.Connection.callproc" title="Permalink to this definition">¶</a></dt>
<dd><p>Call a stored database procedure with the given name.</p>
<p>The sequence of parameters must contain one entry for each argument that
the procedure expects. The result of the call is returned as modified copy
of the input sequence. Input parameters are left untouched, output and
input/output parameters replaced with possibly new values.</p>
<p>The procedure may also provide a result set as output. This must then be
made available through the standard <a class="reference external" href="http://initd.org/psycopg/docs/cursor.html#fetch">fetch*()</a> methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>procname</strong> (<em>string</em>) &#8211; The name of the database procedure.</li>
<li><strong>parameters</strong> (<em>tuple/list</em>) &#8211; A list or tuple with query parameters. See <a class="reference external" href="http://initd.org/psycopg/docs/usage.html#query-parameters">Passing parameters to SQL queries</a>
for more information. Defaults to an empty tuple.</li>
<li><strong>cursor_factory</strong> &#8211; The <tt class="docutils literal"><span class="pre">cursor_factory</span></tt> argument can be used to create non-standard cursors.
The class returned must be a subclass of <a class="reference external" href="http://initd.org/psycopg/docs/extensions.html#psycopg2.extensions.cursor">psycopg2.extensions.cursor</a>.
See <a class="reference external" href="http://initd.org/psycopg/docs/advanced.html#subclassing-cursor">Connection and cursor factories</a> for details. Defaults to <tt class="docutils literal"><span class="pre">None</span></tt>.</li>
<li><strong>callback</strong> (<em>callable</em>) &#8211; A callable that is executed when the query has finished. It must accept
two positional parameters. The first one being the cursor and the second
one <tt class="docutils literal"><span class="pre">None</span></tt> or an instance of an exception if an error has occurred,
in that case the first parameter will be <tt class="docutils literal"><span class="pre">None</span></tt>. Defaults to <tt class="docutils literal"><span class="pre">None</span></tt>.
<strong>NOTE:</strong> <cite>callback</cite> should always passed as keyword argument</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="momoko.Connection.close">
<tt class="descname">close</tt><big>(</big><big>)</big><a class="headerlink" href="#momoko.Connection.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the connection from the IO loop and close it.</p>
</dd></dl>

<dl class="attribute">
<dt id="momoko.Connection.closed">
<tt class="descname">closed</tt><a class="headerlink" href="#momoko.Connection.closed" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates whether the connection is closed or not.</p>
</dd></dl>

<dl class="method">
<dt id="momoko.Connection.execute">
<tt class="descname">execute</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#momoko.Connection.execute" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare and execute a database operation (query or command).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>operation</strong> (<em>string</em>) &#8211; An SQL query.</li>
<li><strong>parameters</strong> (<em>tuple/list</em>) &#8211; A list or tuple with query parameters. See <a class="reference external" href="http://initd.org/psycopg/docs/usage.html#query-parameters">Passing parameters to SQL queries</a>
for more information. Defaults to an empty tuple.</li>
<li><strong>cursor_factory</strong> &#8211; The <tt class="docutils literal"><span class="pre">cursor_factory</span></tt> argument can be used to create non-standard cursors.
The class returned must be a subclass of <a class="reference external" href="http://initd.org/psycopg/docs/extensions.html#psycopg2.extensions.cursor">psycopg2.extensions.cursor</a>.
See <a class="reference external" href="http://initd.org/psycopg/docs/advanced.html#subclassing-cursor">Connection and cursor factories</a> for details. Defaults to <tt class="docutils literal"><span class="pre">None</span></tt>.</li>
<li><strong>callback</strong> (<em>callable</em>) &#8211; A callable that is executed when the query has finished. It must accept
two positional parameters. The first one being the cursor and the second
one <tt class="docutils literal"><span class="pre">None</span></tt> or an instance of an exception if an error has occurred,
in that case the first parameter will be <tt class="docutils literal"><span class="pre">None</span></tt>. Defaults to <tt class="docutils literal"><span class="pre">None</span></tt>.
<strong>NOTE:</strong> <cite>callback</cite> should always passed as keyword argument</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="momoko.Connection.mogrify">
<tt class="descname">mogrify</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#momoko.Connection.mogrify" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a query string after arguments binding.</p>
<p>The string returned is exactly the one that would be sent to the database
running the execute() method or similar.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>operation</strong> (<em>string</em>) &#8211; An SQL query.</li>
<li><strong>parameters</strong> (<em>tuple/list</em>) &#8211; A list or tuple with query parameters. See <a class="reference external" href="http://initd.org/psycopg/docs/usage.html#query-parameters">Passing parameters to SQL queries</a>
for more information. Defaults to an empty tuple.</li>
<li><strong>callback</strong> (<em>callable</em>) &#8211; A callable that is executed when the query has finished. It must accept
two positional parameters. The first one being the resulting query as
a byte string and the second one <tt class="docutils literal"><span class="pre">None</span></tt> or an instance of an exception
if an error has occurred. Defaults to <tt class="docutils literal"><span class="pre">None</span></tt>.
<strong>NOTE:</strong> <cite>callback</cite> should always passed as keyword argument</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="momoko.Connection.ping">
<tt class="descname">ping</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#momoko.Connection.ping" title="Permalink to this definition">¶</a></dt>
<dd><p>Make sure this connection is alive by executing SELECT 1 statement -
i.e. roundtrip to the database.</p>
<dl class="docutils">
<dt><strong>NOTE:</strong> On the contrary to other methods, callback function signature is</dt>
<dd><tt class="docutils literal"><span class="pre">callback(self,</span> <span class="pre">error)</span></tt> and not <tt class="docutils literal"><span class="pre">callback(cursor,</span> <span class="pre">error)</span></tt>.</dd>
</dl>
<p><strong>NOTE:</strong> <cite>callback</cite> should always passed as keyword argument</p>
</dd></dl>

<dl class="method">
<dt id="momoko.Connection.register_hstore">
<tt class="descname">register_hstore</tt><big>(</big><em>globally=False</em>, <em>unicode=False</em>, <em>callback=None</em><big>)</big><a class="headerlink" href="#momoko.Connection.register_hstore" title="Permalink to this definition">¶</a></dt>
<dd><p>Register adapter and typecaster for <tt class="docutils literal"><span class="pre">dict-hstore</span></tt> conversions.</p>
<p>More information on the hstore datatype can be found on the
Psycopg2 <a class="reference external" href="http://initd.org/psycopg/docs/extras.html#hstore-data-type">documentation</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>globally</strong> (<em>boolean</em>) &#8211; Register the adapter globally, not only on this connection.</li>
<li><strong>unicode</strong> (<em>boolean</em>) &#8211; If <tt class="docutils literal"><span class="pre">True</span></tt>, keys and values returned from the database will be <tt class="docutils literal"><span class="pre">unicode</span></tt>
instead of <tt class="docutils literal"><span class="pre">str</span></tt>. The option is not available on Python 3.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>NOTE:</strong> <cite>callback</cite> should always passed as keyword argument</p>
<blockquote>
<div></div></blockquote>
</dd></dl>

<dl class="method">
<dt id="momoko.Connection.register_json">
<tt class="descname">register_json</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#momoko.Connection.register_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Register adapter and typecaster for <tt class="docutils literal"><span class="pre">dict-json</span></tt> conversions.</p>
<p>More information on the json datatype can be found on the
Psycopg2 <a class="reference external" href="http://initd.org/psycopg/docs/extras.html#json-adaptation">documentation</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>globally</strong> (<em>boolean</em>) &#8211; Register the adapter globally, not only on this connection.</li>
<li><strong>loads</strong> (<em>function</em>) &#8211; The function used to parse the data into a Python object.  If <tt class="docutils literal"><span class="pre">None</span></tt>
use <tt class="docutils literal"><span class="pre">json.loads()</span></tt>, where <tt class="docutils literal"><span class="pre">json</span></tt> is the module chosen according to
the Python version.  See psycopg2.extra docs.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>NOTE:</strong> <cite>callback</cite> should always passed as keyword argument</p>
<blockquote>
<div></div></blockquote>
</dd></dl>

<dl class="method">
<dt id="momoko.Connection.transaction">
<tt class="descname">transaction</tt><big>(</big><em>statements</em>, <em>cursor_factory=None</em>, <em>callback=None</em><big>)</big><a class="headerlink" href="#momoko.Connection.transaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a sequence of SQL queries in a database transaction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>statements</strong> (<em>tuple/list</em>) &#8211; <p>List or tuple containing SQL queries with or without parameters. An item
can be a string (SQL query without parameters) or a tuple/list with two items,
an SQL query and a tuple/list wuth parameters.</p>
<p>See <a class="reference external" href="http://initd.org/psycopg/docs/usage.html#query-parameters">Passing parameters to SQL queries</a> for more information.</p>
</li>
<li><strong>cursor_factory</strong> &#8211; The <tt class="docutils literal"><span class="pre">cursor_factory</span></tt> argument can be used to create non-standard cursors.
The class returned must be a subclass of <a class="reference external" href="http://initd.org/psycopg/docs/extensions.html#psycopg2.extensions.cursor">psycopg2.extensions.cursor</a>.
See <a class="reference external" href="http://initd.org/psycopg/docs/advanced.html#subclassing-cursor">Connection and cursor factories</a> for details. Defaults to <tt class="docutils literal"><span class="pre">None</span></tt>.</li>
<li><strong>callback</strong> (<em>callable</em>) &#8211; A callable that is executed when the transaction has finished. It must accept
two positional parameters. The first one being a list of cursors in the same
order as the given statements and the second one <tt class="docutils literal"><span class="pre">None</span></tt> or an instance of
an exception if an error has occurred, in that case the first parameter is
an empty list. Defaults to <tt class="docutils literal"><span class="pre">None</span></tt>.
<strong>NOTE:</strong> <cite>callback</cite> should always passed as keyword argument</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="utilities">
<h2>Utilities<a class="headerlink" href="#utilities" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="momoko.Op">
<em class="property">class </em><tt class="descclassname">momoko.</tt><tt class="descname">Op</tt><big>(</big><em>func</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#momoko.Op" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a single asynchronous operation.</p>
<p>Behaves like <a class="reference external" href="http://www.tornadoweb.org/documentation/gen.html#tornado.gen.Task">tornado.gen.Task</a>, but raises an exception (one of Psycop2&#8217;s
<a class="reference external" href="http://initd.org/psycopg/docs/module.html#exceptions">exceptions</a>) when an error occurs related to Psycopg2 or PostgreSQL.</p>
</dd></dl>

<dl class="class">
<dt id="momoko.WaitOp">
<em class="property">class </em><tt class="descclassname">momoko.</tt><tt class="descname">WaitOp</tt><big>(</big><em>key</em><big>)</big><a class="headerlink" href="#momoko.WaitOp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the argument passed to the result of a previous <a class="reference external" href="http://www.tornadoweb.org/documentation/gen.html#tornado.gen.Callback">tornado.gen.Callback</a>.</p>
<p>Behaves like <a class="reference external" href="http://www.tornadoweb.org/documentation/gen.html#tornado.gen.Wait">tornado.gen.Wait</a>, but raises an exception (one of Psycop2&#8217;s
<a class="reference external" href="http://initd.org/psycopg/docs/module.html#exceptions">exceptions</a>) when an error occurs related to Psycopg2 or PostgreSQL.</p>
</dd></dl>

<dl class="class">
<dt id="momoko.WaitAllOps">
<em class="property">class </em><tt class="descclassname">momoko.</tt><tt class="descname">WaitAllOps</tt><big>(</big><em>keys</em><big>)</big><a class="headerlink" href="#momoko.WaitAllOps" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the results of multiple previous <a class="reference external" href="http://www.tornadoweb.org/documentation/gen.html#tornado.gen.Callback">tornado.gen.Callback</a>.</p>
<p>Behaves like <a class="reference external" href="http://www.tornadoweb.org/documentation/gen.html#tornado.gen.WaitAll">tornado.gen.WaitAll</a>, but raises an exception (one of Psycop2&#8217;s
<a class="reference external" href="http://initd.org/psycopg/docs/module.html#exceptions">exceptions</a>) when an error occurs related to Psycopg2 or PostgreSQL.</p>
</dd></dl>

</div>
<div class="section" id="id14">
<h2>Exceptions<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="momoko.PoolError">
<em class="property">class </em><tt class="descclassname">momoko.</tt><tt class="descname">PoolError</tt><a class="headerlink" href="#momoko.PoolError" title="Permalink to this definition">¶</a></dt>
<dd><p>The <tt class="docutils literal"><span class="pre">PoolError</span></tt> exception is raised when something goes wrong in the connection
pool. When the maximum amount is exceeded for example.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">API</a><ul>
<li><a class="reference internal" href="#connections">Connections</a></li>
<li><a class="reference internal" href="#utilities">Utilities</a></li>
<li><a class="reference internal" href="#id14">Exceptions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tutorial.html"
                        title="previous chapter">Tutorial</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/api.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tutorial.html" title="Tutorial"
             >previous</a> |</li>
        <li><a href="index.html">Momoko 1.1.6 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011-2015, Frank Smit &amp; Zaar Hai.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>