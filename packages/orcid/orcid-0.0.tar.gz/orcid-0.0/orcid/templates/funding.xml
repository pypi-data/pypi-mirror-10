{%- extends "base.xml" -%}
{%- block content -%}
<funding:funding
  xmlns:common="http://www.orcid.org/ns/common" xmlns:funding="http://www.orcid.org/ns/funding"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.orcid.org/ns/funding ../funding-2.0_rc1.xsd "
  {% if record.visibility %}
  visibility="{{ record.visibility }}"
  {% endif %}
  {% if record.put_code %}
  put-code="{{ record.put_code }}"
  {% endif %}>
    <funding:type>{{ record.type }}</funding:type>
    {%- if record.organization_defined_type -%}
    <funding:organization-defined-type>{{ record.organization_defined_type }}</funding:organization-defined-type>
    {%- endif -%}
    {%- if record.title -%}
    <funding:title>
        {%- if record.title.title -%}
        <common:title>{{ record.title.title }}</common:title>
        {%- endif -%}
        {%- if record.title.translated_title -%}
        <common:translated-title language-code="{{ record.title.translated_title.code }}">{{ record.title.translated_title.title }}</common:translated-title>
        {%- endif -%}
    </funding:title>
    {%- endif -%}
    {%- if record.short_description -%}
    <funding:short-description>{{ record.short_description }}</funding:short-description>
    {%- endif -%}
    {%- if record.amount -%}
    <funding:amount currency-code="{{ record.amount.currency_code }}">{{ record.amount.amount }}</funding:amount>
    {%- endif -%}
    {%- if record.url -%}
    <funding:url>{{ record.url }}</funding:url>
    {%- endif -%}
    {%- if record.start_date -%}
    <common:start-date>
        {{ date_xml(record.start_date) }}
    </common:start-date>
    {%- endif -%}
    {%- if record.end_date -%}
    <common:end-date>
        {{ date_xml(record.end_date) }}
    </common:end-date>
    {%- endif -%}
    <funding:external-identifiers>
        {%- for externalIdentifier in record.external_identifiers -%}
        <funding:externalIdentifier>
            <funding:external-identifier-type>{{ externalIdentifier.type }}</funding:external-identifier-type>
            <funding:external-identifier-value>{{ externalIdentifier.value }}</funding:external-identifier-value>
            <funding:external-identifier-url>{{ externalIdentifier.url }}</funding:external-identifier-url>
        </funding:externalIdentifier>
        {%- endfor -%}
    </funding:external-identifiers>
    <funding:contributors>
        {%- for contributor in record.contributors -%}
        <funding:contributor>
            {%- if contributor.orcid -%}
            <common:contributor-orcid>
                {{ contributor_orcid(contributor.orcid) }}
            </common:contributor-orcid>
            {%- endif -%}
            {%- if contributor.credit_name -%}
            <funding:credit-name{%- if contributor.credit_name.visibility -%} visibility="visibility={{ contributor.credit_name.visibility }}"{%- endif -%}>{{ contributor.credit_name.name }}</funding:credit-name>
            {%- endif -%}
            {%- if contributor.email -%}
            <funding:contributor-email>{{ contributor.email }}</funding:contributor-email>
            {%- endif -%}
            {%- if contributor.role -%}
            <funding:contributor-attributes>
                <funding:contributor-role>{{ contributor.role }}</funding:contributor-role>
            </funding:contributor-attributes>
            {%- endif -%}
        </funding:contributor>
        {%- endfor -%}
    </funding:contributors>
    <funding:organization>
        {{ organization(record.organization) }}
    </funding:organization>
</funding:funding>
{%- endblock -%}