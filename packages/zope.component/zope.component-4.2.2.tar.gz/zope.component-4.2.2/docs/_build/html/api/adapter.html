<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Adapter Registration APIs &mdash; zope.configuration 4.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '4.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="zope.configuration 4.0 documentation" href="../index.html" />
    <link rel="up" title="zope.component API Reference" href="../api.html" />
    <link rel="next" title="Factory APIs" href="factory.html" />
    <link rel="prev" title="Utility Registration APIs" href="utility.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="factory.html" title="Factory APIs"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="utility.html" title="Utility Registration APIs"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">zope.configuration 4.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" accesskey="U"><code class="docutils literal"><span class="pre">zope.component</span></code> API Reference</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="adapter-registration-apis">
<h1>Adapter Registration APIs<a class="headerlink" href="#adapter-registration-apis" title="Permalink to this headline">¶</a></h1>
<div class="section" id="conforming-adapter-lookup">
<h2>Conforming Adapter Lookup<a class="headerlink" href="#conforming-adapter-lookup" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="zope.component.getAdapterInContext">
<code class="descclassname">zope.component.</code><code class="descname">getAdapterInContext</code><span class="sig-paren">(</span><em>object</em>, <em>interface</em>, <em>context</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/zope/component/_api.html#getAdapterInContext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#zope.component.getAdapterInContext" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="zope.component.queryAdapterInContext">
<code class="descclassname">zope.component.</code><code class="descname">queryAdapterInContext</code><span class="sig-paren">(</span><em>object</em>, <em>interface</em>, <em>context</em>, <em>default=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/zope/component/_api.html#queryAdapterInContext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#zope.component.queryAdapterInContext" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>The <a class="reference internal" href="#zope.component.getAdapterInContext" title="zope.component.getAdapterInContext"><code class="xref py py-func docutils literal"><span class="pre">getAdapterInContext()</span></code></a> and
<a class="reference internal" href="#zope.component.queryAdapterInContext" title="zope.component.queryAdapterInContext"><code class="xref py py-func docutils literal"><span class="pre">queryAdapterInContext()</span></code></a> APIs first check the
context object to see if it already conforms to the requested interface.
If so, the object is returned immediately.  Otherwise, the adapter factory
is looked up in the site manager, and called.</p>
<p>Let&#8217;s start by creating a component that supports the <cite>__conform__()</cite> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implementer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.tests.examples</span> <span class="kn">import</span> <span class="n">I1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.tests.examples</span> <span class="kn">import</span> <span class="n">I2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@implementer</span><span class="p">(</span><span class="n">I1</span><span class="p">)</span>
<span class="gp">... </span><span class="k">class</span> <span class="nc">Component</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__conform__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iface</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">iface</span> <span class="o">==</span> <span class="n">I2</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="mi">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ob</span> <span class="o">=</span> <span class="n">Component</span><span class="p">()</span>
</pre></div>
</div>
<p>We also gave the component a custom representation, so it will be easier
to use in these tests.</p>
<p>We now have to create a site manager (other than the default global one)
with which we can register adapters for <cite>I1</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.globalregistry</span> <span class="kn">import</span> <span class="n">BaseGlobalComponents</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sitemanager</span> <span class="o">=</span> <span class="n">BaseGlobalComponents</span><span class="p">()</span>
</pre></div>
</div>
<p>Now we create a new <cite>context</cite> that knows how to get to our custom site
manager.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.tests.examples</span> <span class="kn">import</span> <span class="n">ConformsToIComponentLookup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span> <span class="o">=</span> <span class="n">ConformsToIComponentLookup</span><span class="p">(</span><span class="n">sitemanager</span><span class="p">)</span>
</pre></div>
</div>
<p>If an object implements the interface you want to adapt to,
<cite>getAdapterInContext()</cite> should simply return the object.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getAdapterInContext</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">queryAdapterInContext</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getAdapterInContext</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">I1</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span> <span class="ow">is</span> <span class="n">ob</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">queryAdapterInContext</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">I1</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span> <span class="ow">is</span> <span class="n">ob</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If an object conforms to the interface you want to adapt to,
<cite>getAdapterInContext()</cite> should simply return the conformed object.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">getAdapterInContext</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
<span class="go">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">queryAdapterInContext</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
<span class="go">42</span>
</pre></div>
</div>
<p>If an adapter isn&#8217;t registered for the given object and interface, and you
provide no default, the <cite>getAdapterInContext</cite> API raises ComponentLookupError:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">I4</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">getAdapterInContext</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">I4</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ComponentLookupError</span>: <span class="n">(&lt;Component implementing &#39;I1&#39;&gt;,</span>
<span class="go">                       &lt;InterfaceClass ...I4&gt;)</span>
</pre></div>
</div>
<p>While the <cite>queryAdapterInContext</cite> API returns the default:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">queryAdapterInContext</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">I4</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="mi">44</span><span class="p">)</span>
<span class="go">44</span>
</pre></div>
</div>
<p>If you ask for an adapter for which something&#8217;s registered you get the
registered adapter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.tests.examples</span> <span class="kn">import</span> <span class="n">I3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sitemanager</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">43</span><span class="p">,</span> <span class="p">(</span><span class="n">I1</span><span class="p">,),</span> <span class="n">I3</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getAdapterInContext</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">I3</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
<span class="go">43</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">queryAdapterInContext</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">I3</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
<span class="go">43</span>
</pre></div>
</div>
</div>
<div class="section" id="named-adapter-lookup">
<h2>Named Adapter Lookup<a class="headerlink" href="#named-adapter-lookup" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="zope.component.getAdapter">
<code class="descclassname">zope.component.</code><code class="descname">getAdapter</code><span class="sig-paren">(</span><em>object</em>, <em>interface=&lt;InterfaceClass zope.interface.Interface&gt;</em>, <em>name=u''</em>, <em>context=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/zope/component/_api.html#getAdapter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#zope.component.getAdapter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="zope.component.queryAdapter">
<code class="descclassname">zope.component.</code><code class="descname">queryAdapter</code><span class="sig-paren">(</span><em>object</em>, <em>interface=&lt;InterfaceClass zope.interface.Interface&gt;</em>, <em>name=u''</em>, <em>default=None</em>, <em>context=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/zope/component/_api.html#queryAdapter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#zope.component.queryAdapter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>The <code class="docutils literal"><span class="pre">getAdapter</span></code> and <code class="docutils literal"><span class="pre">queryAdapter</span></code> API functions are similar to
<code class="docutils literal"><span class="pre">{get|query}AdapterInContext()</span></code> functions, except that they do not care
about the <code class="docutils literal"><span class="pre">__conform__()</span></code> but also handle named adapters. (Actually, the
name is a required argument.)</p>
<p>If no adapter is registered for the given object, interface, and name,
<code class="docutils literal"><span class="pre">getAdapter</span></code> raises <code class="docutils literal"><span class="pre">ComponentLookupError</span></code>, while <code class="docutils literal"><span class="pre">queryAdapter</span></code>
returns the default:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getAdapter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">queryAdapter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.tests.examples</span> <span class="kn">import</span> <span class="n">I2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.tests.examples</span> <span class="kn">import</span> <span class="n">ob</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getAdapter</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ComponentLookupError</span>: <span class="n">(&lt;instance Ob&gt;,</span>
<span class="go">                       &lt;InterfaceClass zope.component.tests.examples.I2&gt;,</span>
<span class="go">                       &#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">queryAdapter</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;default&gt;&#39;</span><span class="p">)</span>
<span class="go">&#39;&lt;default&gt;&#39;</span>
</pre></div>
</div>
<p>The &#8216;requires&#8217; argument to <cite>registerAdapter</cite> must be a sequence, rather than
a single interface:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.tests.examples</span> <span class="kn">import</span> <span class="n">Comp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">Comp</span><span class="p">,</span> <span class="n">I1</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  <span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">the required argument should be a list of interfaces, not a single interface</span>
</pre></div>
</div>
<p>After register an adapter from <cite>I1</cite> to <cite>I2</cite> with the global site manager:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.tests.examples</span> <span class="kn">import</span> <span class="n">Comp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">Comp</span><span class="p">,</span> <span class="p">(</span><span class="n">I1</span><span class="p">,),</span> <span class="n">I2</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We can access the adapter using the <cite>getAdapter()</cite> API:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">adapted</span> <span class="o">=</span> <span class="n">getAdapter</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapted</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">is</span> <span class="n">Comp</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapted</span><span class="o">.</span><span class="n">context</span> <span class="ow">is</span> <span class="n">ob</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapted</span> <span class="o">=</span> <span class="n">queryAdapter</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapted</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">is</span> <span class="n">Comp</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapted</span><span class="o">.</span><span class="n">context</span> <span class="ow">is</span> <span class="n">ob</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If we search using a non-anonymous name, before registering:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">getAdapter</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="s">&#39;named&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ComponentLookupError</span>: <span class="n">(&lt;instance Ob&gt;,</span>
<span class="go">                       &lt;InterfaceClass ....I2&gt;,</span>
<span class="go">                       &#39;named&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">queryAdapter</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="s">&#39;named&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;default&gt;&#39;</span><span class="p">)</span>
<span class="go">&#39;&lt;default&gt;&#39;</span>
</pre></div>
</div>
<p>After registering under that name:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">Comp</span><span class="p">,</span> <span class="p">(</span><span class="n">I1</span><span class="p">,),</span> <span class="n">I2</span><span class="p">,</span> <span class="s">&#39;named&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapted</span> <span class="o">=</span> <span class="n">getAdapter</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="s">&#39;named&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapted</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">is</span> <span class="n">Comp</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapted</span><span class="o">.</span><span class="n">context</span> <span class="ow">is</span> <span class="n">ob</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapted</span> <span class="o">=</span> <span class="n">queryAdapter</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="s">&#39;named&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapted</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">is</span> <span class="n">Comp</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapted</span><span class="o">.</span><span class="n">context</span> <span class="ow">is</span> <span class="n">ob</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="invoking-an-interface-to-perform-adapter-lookup">
<h2>Invoking an Interface to Perform Adapter Lookup<a class="headerlink" href="#invoking-an-interface-to-perform-adapter-lookup" title="Permalink to this headline">¶</a></h2>
<p><code class="xref py py-mod docutils literal"><span class="pre">zope.component</span></code> registers an adapter hook with
<code class="xref py py-mod docutils literal"><span class="pre">zope.interface.interface</span></code>, allowing a convenient spelling for
adapter lookup:  just &#8220;call&#8221; the interface, passing the context:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">adapted</span> <span class="o">=</span> <span class="n">I2</span><span class="p">(</span><span class="n">ob</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapted</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">is</span> <span class="n">Comp</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapted</span><span class="o">.</span><span class="n">context</span> <span class="ow">is</span> <span class="n">ob</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If the lookup fails, we get a <cite>TypeError</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">I2</span><span class="p">(</span><span class="nb">object</span><span class="p">())</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">(&#39;Could not adapt&#39;...</span>
</pre></div>
</div>
<p>unless we pass a default:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">marker</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapted</span> <span class="o">=</span> <span class="n">I2</span><span class="p">(</span><span class="nb">object</span><span class="p">(),</span> <span class="n">marker</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapted</span> <span class="ow">is</span> <span class="n">marker</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="registering-adapters-for-arbitrary-objects">
<h2>Registering Adapters For Arbitrary Objects<a class="headerlink" href="#registering-adapters-for-arbitrary-objects" title="Permalink to this headline">¶</a></h2>
<p>Providing an adapter for None says that your adapter can adapt anything
to <cite>I2</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">Comp</span><span class="p">,</span> <span class="p">(</span><span class="bp">None</span><span class="p">,),</span> <span class="n">I2</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapter</span> <span class="o">=</span> <span class="n">I2</span><span class="p">(</span><span class="n">ob</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapter</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">is</span> <span class="n">Comp</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapter</span><span class="o">.</span><span class="n">context</span> <span class="ow">is</span> <span class="n">ob</span>
<span class="go">True</span>
</pre></div>
</div>
<p>It can really adapt any arbitrary object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">something</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapter</span> <span class="o">=</span> <span class="n">I2</span><span class="p">(</span><span class="n">something</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapter</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">is</span> <span class="n">Comp</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapter</span><span class="o">.</span><span class="n">context</span> <span class="ow">is</span> <span class="n">something</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="looking-up-adapters-using-multiple-objects">
<h2>Looking Up Adapters Using Multiple Objects<a class="headerlink" href="#looking-up-adapters-using-multiple-objects" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="zope.component.getMultiAdapter">
<code class="descclassname">zope.component.</code><code class="descname">getMultiAdapter</code><span class="sig-paren">(</span><em>objects</em>, <em>interface=&lt;InterfaceClass zope.interface.Interface&gt;</em>, <em>name=u''</em>, <em>context=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/zope/component/_api.html#getMultiAdapter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#zope.component.getMultiAdapter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="zope.component.queryMultiAdapter">
<code class="descclassname">zope.component.</code><code class="descname">queryMultiAdapter</code><span class="sig-paren">(</span><em>objects</em>, <em>interface=&lt;InterfaceClass zope.interface.Interface&gt;</em>, <em>name=u''</em>, <em>default=None</em>, <em>context=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/zope/component/_api.html#queryMultiAdapter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#zope.component.queryMultiAdapter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Multi-adapters adapt one or more objects to another interface. To make
this demonstration non-trivial, we need to create a second object to be
adapted:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.tests.examples</span> <span class="kn">import</span> <span class="n">Ob2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ob2</span> <span class="o">=</span> <span class="n">Ob2</span><span class="p">()</span>
</pre></div>
</div>
<p>As with regular adapters, if an adapter isn&#8217;t registered for the given
objects and interface, the <a class="reference internal" href="#zope.component.getMultiAdapter" title="zope.component.getMultiAdapter"><code class="xref py py-func docutils literal"><span class="pre">getMultiAdapter()</span></code></a> API
raises <cite>ComponentLookupError</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getMultiAdapter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getMultiAdapter</span><span class="p">((</span><span class="n">ob</span><span class="p">,</span> <span class="n">ob2</span><span class="p">),</span> <span class="n">I3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ComponentLookupError</span>:
<span class="go">((&lt;instance Ob&gt;, &lt;instance Ob2&gt;),</span>
<span class="go"> &lt;InterfaceClass zope.component.tests.examples.I3&gt;,</span>
<span class="go"> u&#39;&#39;)</span>
</pre></div>
</div>
<p>while the <a class="reference internal" href="#zope.component.queryMultiAdapter" title="zope.component.queryMultiAdapter"><code class="xref py py-func docutils literal"><span class="pre">queryMultiAdapter()</span></code></a> API returns the default:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">queryMultiAdapter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">queryMultiAdapter</span><span class="p">((</span><span class="n">ob</span><span class="p">,</span> <span class="n">ob2</span><span class="p">),</span> <span class="n">I3</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;&lt;default&gt;&#39;</span><span class="p">)</span>
<span class="go">&#39;&lt;default&gt;&#39;</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal"><span class="pre">name</span></code> is not a required attribute here.</p>
<p>To test multi-adapters, we also have to create an adapter class that
handles to context objects:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implementer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@implementer</span><span class="p">(</span><span class="n">I3</span><span class="p">)</span>
<span class="gp">... </span><span class="k">class</span> <span class="nc">DoubleAdapter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="n">first</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">second</span> <span class="o">=</span> <span class="n">second</span>
</pre></div>
</div>
<p>Now we can register the multi-adapter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getGlobalSiteManager</span><span class="p">()</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">DoubleAdapter</span><span class="p">,</span> <span class="p">(</span><span class="n">I1</span><span class="p">,</span> <span class="n">I2</span><span class="p">),</span> <span class="n">I3</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice how the required interfaces are simply provided by a tuple.</p>
<p>Now we can get the adapter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">adapter</span> <span class="o">=</span> <span class="n">getMultiAdapter</span><span class="p">((</span><span class="n">ob</span><span class="p">,</span> <span class="n">ob2</span><span class="p">),</span> <span class="n">I3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapter</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">is</span> <span class="n">DoubleAdapter</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapter</span><span class="o">.</span><span class="n">first</span> <span class="ow">is</span> <span class="n">ob</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapter</span><span class="o">.</span><span class="n">second</span> <span class="ow">is</span> <span class="n">ob2</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="finding-more-than-one-adapter">
<h2>Finding More Than One Adapter<a class="headerlink" href="#finding-more-than-one-adapter" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="zope.component.getAdapters">
<code class="descclassname">zope.component.</code><code class="descname">getAdapters</code><span class="sig-paren">(</span><em>objects</em>, <em>provided</em>, <em>context=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/zope/component/_api.html#getAdapters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#zope.component.getAdapters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>It is sometimes desireable to get a list of all adapters that are
registered for a particular output interface, given a set of
objects.</p>
<p>Let&#8217;s register some adapters first:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">I5</span><span class="p">(</span><span class="n">I1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">Comp</span><span class="p">,</span> <span class="p">[</span><span class="n">I1</span><span class="p">],</span> <span class="n">I5</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">Comp</span><span class="p">,</span> <span class="p">[</span><span class="bp">None</span><span class="p">],</span> <span class="n">I5</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we get all the adapters that are registered for <code class="docutils literal"><span class="pre">ob</span></code> that provide
<code class="docutils literal"><span class="pre">I5</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getAdapters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapters</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">getAdapters</span><span class="p">((</span><span class="n">ob</span><span class="p">,),</span> <span class="n">I5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="n">name</span><span class="p">,</span> <span class="n">adapter</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">adapter</span> <span class="ow">in</span> <span class="n">adapters</span><span class="p">]</span>
<span class="go">[(u&#39;&#39;, &#39;Comp&#39;), (u&#39;foo&#39;, &#39;Comp&#39;)]</span>
</pre></div>
</div>
<p>Note that the output doesn&#8217;t include None values. If an adapter
factory returns None, it is as if it wasn&#8217;t present.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">context</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="p">[</span><span class="n">I1</span><span class="p">],</span> <span class="n">I5</span><span class="p">,</span> <span class="s">&#39;nah&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adapters</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">getAdapters</span><span class="p">((</span><span class="n">ob</span><span class="p">,),</span> <span class="n">I5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="n">name</span><span class="p">,</span> <span class="n">adapter</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">adapter</span> <span class="ow">in</span> <span class="n">adapters</span><span class="p">]</span>
<span class="go">[(u&#39;&#39;, &#39;Comp&#39;), (u&#39;foo&#39;, &#39;Comp&#39;)]</span>
</pre></div>
</div>
</div>
<div class="section" id="subscription-adapters">
<h2>Subscription Adapters<a class="headerlink" href="#subscription-adapters" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="zope.component.subscribers">
<code class="descclassname">zope.component.</code><code class="descname">subscribers</code><span class="sig-paren">(</span><em>objects</em>, <em>interface</em>, <em>context=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/zope/component/_api.html#subscribers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#zope.component.subscribers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="event-handlers">
<h2>Event handlers<a class="headerlink" href="#event-handlers" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="zope.component.handle">
<code class="descclassname">zope.component.</code><code class="descname">handle</code><span class="sig-paren">(</span><em>*objects</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/zope/component/_api.html#handle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#zope.component.handle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="helpers-for-declaring-testing-adapters">
<h2>Helpers for Declaring / Testing Adapters<a class="headerlink" href="#helpers-for-declaring-testing-adapters" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="zope.component.adapter">
<code class="descclassname">zope.component.</code><code class="descname">adapter</code><span class="sig-paren">(</span><em>*interfaces</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/zope/component/_declaration.html#adapter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#zope.component.adapter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="zope.component.adaptedBy">
<code class="descclassname">zope.component.</code><code class="descname">adaptedBy</code><span class="sig-paren">(</span><em>ob</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/zope/component/_declaration.html#adaptedBy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#zope.component.adaptedBy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="zope.component.adapts">
<code class="descclassname">zope.component.</code><code class="descname">adapts</code><span class="sig-paren">(</span><em>*interfaces</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/zope/component/_declaration.html#adapts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#zope.component.adapts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Adapter Registration APIs</a><ul>
<li><a class="reference internal" href="#conforming-adapter-lookup">Conforming Adapter Lookup</a></li>
<li><a class="reference internal" href="#named-adapter-lookup">Named Adapter Lookup</a></li>
<li><a class="reference internal" href="#invoking-an-interface-to-perform-adapter-lookup">Invoking an Interface to Perform Adapter Lookup</a></li>
<li><a class="reference internal" href="#registering-adapters-for-arbitrary-objects">Registering Adapters For Arbitrary Objects</a></li>
<li><a class="reference internal" href="#looking-up-adapters-using-multiple-objects">Looking Up Adapters Using Multiple Objects</a></li>
<li><a class="reference internal" href="#finding-more-than-one-adapter">Finding More Than One Adapter</a></li>
<li><a class="reference internal" href="#subscription-adapters">Subscription Adapters</a></li>
<li><a class="reference internal" href="#event-handlers">Event handlers</a></li>
<li><a class="reference internal" href="#helpers-for-declaring-testing-adapters">Helpers for Declaring / Testing Adapters</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="utility.html"
                        title="previous chapter">Utility Registration APIs</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="factory.html"
                        title="next chapter">Factory APIs</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/api/adapter.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="factory.html" title="Factory APIs"
             >next</a> |</li>
        <li class="right" >
          <a href="utility.html" title="Utility Registration APIs"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">zope.configuration 4.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" ><code class="docutils literal"><span class="pre">zope.component</span></code> API Reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2012, Zope Foundation Contributors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>