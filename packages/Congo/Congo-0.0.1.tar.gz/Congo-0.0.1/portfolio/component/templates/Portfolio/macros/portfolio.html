"""
Portfolio's macro
"""
{% import "Portfolio/macros/meta.html" as meta with context %}


"""
"""
{% macro oauth_login_buttons(buttons, size="md", text="Signin with #provider") %}
    {% for button in buttons %}
        {% set name = button %}
        {% if button == "google" %}
            {% set button = "google-plus" %}
        {% endif %}
        {% set text = text.replace("#provider", name) %}

        {{ oauth_login_button(button, text, size) }}
    {% endfor %}
{% endmacro %}


{#:: oauth_login_button
    Create a social login button
::#}
{% macro oauth_login_button(button, text, size="") %}
    <a pylot:oauth--login="{{ button }}" href="{{ url_for('UserAccount:login_auth', provider='facebook') }}"
       class="btn btn-social btn-{{ button }} btn-{{ size }} oauth-login-- authomatic" >
      <i class="fa fa-{{ button }}"></i>
      {{ text | title }}
    </a>
{% endmacro %}


{#:: static_file(url) ::#}
{#:: Include static assets ::#}
{%- macro static_file(url) -%}
    {%- if not url.startswith('http') and not url.startswith('//')  -%}
        {%- set url = url_for('static', filename=url) -%}
    {%- endif -%}
    {{- url | safe -}}
{%- endmacro -%}


{#:: css(file) ::#}
{#:: include css files ::#}
{%- macro css(file) -%}
    <link href="{{ static_file(file) }}" rel="stylesheet">
{%- endmacro -%}


{#:: js(file) ::#}
{#:: include js file ::#}
{%- macro js(file) -%}
    <script type="text/javascript" src="{{ static_file(file) }}"></script>
{%- endmacro -%}


{#:: img(file, attributes) ::#}
{#:: Insert img tag ::#}
{% macro img(file, attributes={}) %}
    <img src="{{ static_file(file) }}"
            {%- for k, v in attributes.items() %}
                {{ k | safe}}="{{ v | safe}}"
            {% endfor -%}
            >
{% endmacro %}

{#::  google_analytics ::#}
{#:: include google analytics tags ::#}


#-------------------------------------------------------------------------------
"""
CSS_ASSETS
"""
{%- macro css_assets(files) %}
    {%- assets files %}
    <link rel="stylesheet" href="{{ ASSET_URL }}" type="text/css" >
    {% endassets -%}
{% endmacro -%}

#-------------------------------------------------------------------------------
"""
JS_ASSETS
"""
{%- macro js_assets(files) %}
    {%- assets files %}
    <script type="text/javascript" src="{{ ASSET_URL }}"></script>
    {% endassets -%}
{% endmacro -%}


#---- flashed_messages() -------------------------------------------------------
# Render the flashed messages set
{% macro flashed_messages(dismissible=True) %}
    {% for category, message in get_flashed_messages(with_categories=True) %}
        <div class="alert
            alert-{{category|replace('error', 'danger')}}
            {% if dismissible %}alert-dismissible{%endif%}
            " role="alert">
            {% if dismissible %}
             <button type="button" class="close" data-dismiss="alert">
                 <span aria-hidden="true">&times;</span>
                 <span class="sr-only">Close</span>
             </button>
            {%endif%}
            {{message}}
        </div>
    {%endfor%}
{% endmacro %}



#-------------------------------------------------------------------------------
"""
Alert
"""
{% macro alert(message, category="info", dismissible=True) %}
    <div class="alert
        alert-{{category|replace('error', 'danger')}}
        {% if dismissible %}alert-dismissible{%endif%}
        " role="alert">
        {% if dismissible %}
         <button type="button" class="close" data-dismiss="alert">
             <span aria-hidden="true">&times;</span>
             <span class="sr-only">Close</span>
         </button>
        {%endif%}
        {{message}}
    </div>
{% endmacro %}


#-------------------------------------------------------------------------------
"""
Pagination
"""
{% macro pagination(paginator, endpoint=None, class_='pagination') %}
    {% if not endpoint %}
        {% set endpoint = request.endpoint %}
    {% endif %}
    {% if "page" in kwargs %}
        {% set _ = kwargs.pop("page") %}
    {% endif %}
    <nav>
        <ul class="{{ class_ }}">
          {%- if paginator.has_prev %}
            <li><a href="{{ url_for(endpoint, page=paginator.prev_page_number, **kwargs) }}"
             rel="me prev"><span aria-hidden="true">&laquo;</span></a></li>
          {% else %}
            <li class="disabled"><span><span aria-hidden="true">&laquo;</span></span></li>
          {%- endif %}

          {%- for page in paginator.pages %}
            {% if page %}
              {% if page != paginator.page %}
                <li><a href="{{ url_for(endpoint, page=page, **kwargs) }}"
                 rel="me">{{ page }}</a></li>
              {% else %}
                <li class="active"><span>{{ page }}</span></li>
              {% endif %}
            {% else %}
              <li><span class=ellipsis>…</span></li>
            {% endif %}
          {%- endfor %}

          {%- if paginator.has_next %}
            <li><a href="{{ url_for(endpoint, page=paginator.next_page_number, **kwargs) }}"
             rel="me next">»</a></li>
          {% else %}
            <li class="disabled"><span aria-hidden="true">&raquo;</span></li>
          {%- endif %}
        </ul>
    </nav>
{% endmacro %}


#-------------------------------------------------------------------------------
"""
Social_Graph
"""
{%- macro social_graph(use_opengraph=True, use_googleplus=True, use_twitter=True) -%}
    {%- if __.META_DATA["use_opengraph"] and use_opengraph -%}
        {%- set __meta = ["title", "url", "description", "image", "object_type", "site_name"] -%}
        {% for _m in __meta -%}
        {%- if _m == "object_type" -%}
            {{- meta.opengraph("type", __.META_DATA[_m]) -}}
        {%- else -%}
            {{- meta.opengraph(_m, __.META_DATA[_m]) -}}
        {%- endif -%}
        {% endfor %}
    {%- endif -%}

    {%- if __.META_DATA["use_googleplus"] and use_googleplus -%}
        {%- set __meta = ["title", "url", "description", "image"] -%}
        {% for _m in __meta -%}
        {%- if _m == "title" -%}
            {{- meta.googleplus("name", __.META_DATA[_m]) -}}
        {%- else -%}
            {{- meta.googleplus(_m, __.META_DATA[_m]) -}}
        {%- endif -%}
        {% endfor %}
    {%- endif -%}

    {% if __.META_DATA["use_twitter"] and use_twitter -%}
        {%- set __meta = ["title", "url", "description", "image"] -%}
        {% for _m in __meta -%}
        {{- meta.twitter(_m, __.META_DATA[_m]) -}}
        {% endfor %}
    {%- endif -%}
{%- endmacro -%}

#-------------------------------------------------------------------------------

{%- macro jquery() -%}
    {{- js_assets('portfolio/vendor/jquery/dist/jquery.min.js') -}}
{%- endmacro -%}

#-------------------------------------------------------------------------------

{%- macro fontawesome(version="4.3.0") -%}
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/{{ version }}/css/font-awesome.min.css">
{%- endmacro -%}

#-------------------------------------------------------------------------------

{% macro bootstrap() %}
    {{- css_assets('portfolio/vendor/bootstrap/dist/css/bootstrap.min.css') -}}
    {{- js_assets('portfolio/vendor/bootstrap/dist/js/bootstrap.min.js') -}}
{% endmacro %}

#-------------------------------------------------------------------------------

{% macro bootswatch(theme) %}
    {{ css_assets('portfolio/vendor/bootswatch/%s.css' % theme) }}
{% endmacro %}

#-------------------------------------------------------------------------------

"""
Google_Analytics
"""
{%- macro google_analytics(code=None) -%}
    {%- if not code %}
        {% set code = __.GOOGLE_ANALYTICS_ID %}
    {% endif -%}
    {%- if code %}
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;meta.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
	  ga('create', '{{ code }}', 'auto');
	  ga('send', 'pageview');
	</script>
    {% endif -%}
{%- endmacro -%}

#-------------------------------------------------------------------------------
"""
Head_Section
"""
{%- macro head_section(title="%s", favicon="favicon.ico", charset="utf-8") -%}
    <meta charset="{{ charset | safe }}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title | replace("%s", __.META_DATA["title"]) | safe }}</title>
    {{ meta.meta("description", __.META_DATA["description"]) }}
    {{ meta.favicon(favicon) }}
    {{ social_graph() }}
    {{ jquery() }}
    {{ fontawesome() }}
    {{ bootstrap() }}
    {{ google_analytics() }}
{%- endmacro -%}

